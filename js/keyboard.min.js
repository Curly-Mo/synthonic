var keys=Array(256);keys[65]=42;keys[90]=43;keys[83]=44;keys[88]=45;keys[68]=46;keys[67]=47;keys[86]=48;keys[71]=49;keys[66]=50;keys[72]=51;keys[78]=52;keys[77]=53;keys[75]=54;keys[188]=55;keys[76]=56;keys[190]=57;keys[186]=58;keys[191]=59;keys[81]=60;keys[50]=61;keys[87]=62;keys[51]=63;keys[69]=64;keys[82]=65;keys[53]=66;keys[84]=67;keys[54]=68;keys[89]=69;keys[55]=70;keys[85]=71;keys[73]=72;keys[57]=73;keys[79]=74;keys[48]=75;keys[80]=76;keys[219]=77;keys[187]=78;keys[221]=79;keys[220]=80;
var currentOctave=3;function keyDown(a){(a=keys[a.keyCode])&&noteOn(a+12*(3-currentOctave),.75);return!1}function keyUp(a){(a=keys[a.keyCode])&&noteOff(a+12*(3-currentOctave));return!1}var pointers=[];
function touchstart(a){for(var b=0;b<a.targetTouches.length;b++){var c=a.targetTouches[0],e=c.target,d=parseInt(e.id.substring(1));console.log("touchstart: id: "+e.id+"identifier: "+c.identifier+" note:"+d);isNaN(d)||(noteOn(d+12*(3-currentOctave),.75),document.getElementById("keybox"),pointers[c.identifier]=d)}a.preventDefault()}
function touchmove(a){for(var b=0;b<a.targetTouches.length;b++){var c=a.targetTouches[0],e=c.target,d=parseInt(e.id.substring(1));console.log("touchmove: id: "+e.id+"identifier: "+c.identifier+" note:"+d);!isNaN(d)&&pointers[c.identifier]&&pointers[c.identifier]!=d&&(noteOff(pointers[c.identifier]+12*(3-currentOctave)),noteOn(d+12*(3-currentOctave),.75),document.getElementById("keybox"),pointers[c.identifier]=d)}a.preventDefault()}
function touchend(a){var b=parseInt(a.target.id.substring(1));console.log("touchend: id: "+a.target.id+" note:"+b);NaN!=b&&noteOff(b+12*(3-currentOctave));pointers[a.pointerId]=null;document.getElementById("keybox");a.preventDefault()}function touchcancel(a){console.log("touchcancel");a.preventDefault()}
function pointerDown(a){console.log(a);var b=parseInt(a.target.id.substring(1));isNaN(b)||(noteOn(b+12*(3-currentOctave),.75),document.getElementById("keybox"),pointers[a.pointerId]=b);a.preventDefault()}function pointerMove(a){var b=parseInt(a.target.id.substring(1));!isNaN(b)&&pointers[a.pointerId]&&pointers[a.pointerId]!=b&&(pointers[a.pointerId]&&noteOff(pointers[a.pointerId]+12*(3-currentOctave)),noteOn(b+12*(3-currentOctave),.75),pointers[a.pointerId]=b);a.preventDefault()}
function pointerUp(a){var b=parseInt(a.target.id.substring(1));NaN!=b&&noteOff(b+12*(3-currentOctave));pointers[a.pointerId]=null;document.getElementById("keybox");a.preventDefault()}function initKeyboard(){keybox=document.getElementById("keybox");keybox.addEventListener("mousedown",pointerDown);keybox.addEventListener("mousemove",pointerMove);keybox.addEventListener("mouseup",pointerUp);window.addEventListener("keydown",keyDown,!1);window.addEventListener("keyup",keyUp,!1)}
document.addEventListener("DOMContentLoaded",function(){initKeyboard()},!1);
